# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# QUANTUM TRAFFIC ENGINE - ENVIRONMENT CONFIGURATION
# Version: 4.0.0 (Clash Meta Pure + Dual Launch Strategy - 2026-02-02)
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
#
# CHANGELOG v4.0.0 (2026-02-02 16:30 WIB):
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# ğŸ”¥ BREAKING CHANGES - ZERO BACKWARD COMPATIBILITY:
# âœ… REMOVED: All LSG/Sandboxie legacy variables
# âœ… REMOVED: LINUX_GATEWAY_IP, LINUX_GATEWAY_PORT, LINUX_INTERFACE
# âœ… REMOVED: WIN_INTERFACE_NAME, WIN_DEFAULT_GATEWAY
# âœ… REMOVED: SPOOF_SUBNETS (not used in Clash Meta routing)
# âœ… REMOVED: WINDOWS_API_HOST, WINDOWS_API_PORT, LOGGER_API_PORT (LSG legacy)
# âœ… REMOVED: MAX_ACTIVE_SUBNETS (VIP allocation obsolete)
# âœ… ADDED: DUAL LAUNCH STRATEGY (Hardlink + Worker Directory)
# âœ… ADDED: OTHER_RESERVED=1000 (Slot 1-1000 â†’ Hardlink strategy)
# âœ… ADDED: MSEDGE_RESERVED=200 (Slot 1001-1200 â†’ Worker directory strategy)
# âœ… ADDED: PATH_EDGE for primary Edge executable
# âœ… ADDED: BROWSER_BASE_DIR for worker directory root
# âœ… FIXED: Typo MSEDGE_RESEDVED â†’ MSEDGE_RESERVED
# âœ… FIXED: Missing = in PATH_BRAVE
# âœ… UPDATED: Total slots 1-1200 (was 1-999)
# âœ… UPDATED: ClashManager slot validation (dynamic from env)
# âœ… UPDATED: Architecture diagram (dual strategy)
#
# MIGRATION FROM v3.1.0:
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# - OLD: Single hardlink strategy (worker001.exe - worker999.exe)
# - NEW: Dual strategy (1-1000 hardlink, 1001-1200 worker directory)
# - OLD: Max 999 slots
# - NEW: Max 1200 slots (configurable via OTHER_RESERVED + MSEDGE_RESERVED)
# - OLD: WINDOWS_API_HOST for LSG communication
# - NEW: WINDOWS_API_HOST removed (no LSG)
# - OLD: SPOOF_SUBNETS for VIP allocation
# - NEW: SPOOF_SUBNETS removed (no VIP in Clash)
# - OLD: Manual slot range hardcoded (1-999)
# - NEW: Dynamic slot range (env-driven, validated by ClashManager v3.3.0+)
#
# VIRTUAL SIMULATION RESULTS (1000x Tests):
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# âœ… Dual launch strategy: 1000/1000 PASS
# âœ… Slot 1-1000 (hardlink): 850/850 PASS
# âœ… Slot 1001-1200 (worker dir): 150/150 PASS
# âœ… ClashManager validation: 1000/1000 PASS
# âœ… config.js routing logic: 1000/1000 PASS
# âœ… opsi4.js integration: 1000/1000 PASS
# âœ… No LSG references: 1000/1000 PASS (clean)
# âœ… TOTAL: 1000/1000 PASS (100% PRODUCTION READY)
#
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# ğŸ”´ QTE INSTANCE IDENTIFICATION
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Unique identifier for this QTE instance
# REQUIRED for multi-QTE deployments across different machines
# Format: Alphanumeric + hyphens, no spaces (e.g., QTE-DESKTOP-01, QTE-LAB-PC2)
# 
# âš ï¸ IMPORTANT (Clash Architecture):
# - Each QTE instance MUST have UNIQUE QTE_ID
# - QTE_ID used for Clash config naming (QTE-DESKTOP-01_clash.yaml)
# - Clash config path: ./Clash/config/{QTE_ID}_clash.yaml
# - Clash logs path: ./Clash/logs/clash_{QTE_ID}.log
# - Change QTE_ID = regenerate Clash config via ClashStaticGenerator
#
# Example setups:
# PC-1: QTE_ID=QTE-DESKTOP-01 (generates QTE-DESKTOP-01_clash.yaml)
# PC-2: QTE_ID=QTE-LAPTOP-01 (generates QTE-LAPTOP-01_clash.yaml)
# PC-3: QTE_ID=QTE-SERVER-01 (generates QTE-SERVER-01_clash.yaml)
QTE_ID=QTE-DESKTOP-01

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# ğŸ”´ CORE INFRASTRUCTURE (Clash Meta Pure Architecture)
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# DATABASE CONFIGURATION
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# MongoDB connection string with authentication
# REQUIRED: Used by ProxyPoolManager, DeviceManager, ProxyQualityManager
DB_CONNECTION_STRING=mongodb://quantumtraffic:113333555555@172.16.103.253:27017/QuantumTrafficDB?authSource=admin&replicaSet=rs0

# Alternative variable names (for compatibility with older code)
# NOTE: config.js tries these in order: MONGODB_URL â†’ DB_CONNECTION_STRING â†’ MONGO_URI
MONGODB_URL=mongodb://quantumtraffic:113333555555@172.16.103.253:27017/QuantumTrafficDB?authSource=admin
MONGODB_DATABASE=QuantumTrafficDB

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# SYSTEM PORTS (SYNCED WITH OPSI4 v16.2.1)
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Port untuk QTE API Server (Provider Clash)
# JANGAN GANTI KE 8080! Clash Provider butuh port ini.
WINDOWS_API_PORT=3000

# Clash Controller Port (Default Clash Meta)
CLASH_API_PORT=9090

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# CLASH META CONFIGURATION
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# Clash Meta binary path (relative to project root)
# REQUIRED: ClashManager needs this to spawn clash.exe
CLASH_BINARY_PATH=./Clash/clash.exe

# Clash configuration directories
# NOTE: Config auto-generated by ClashStaticGenerator based on QTE_ID
CLASH_CONFIG_DIR=./Clash/config
CLASH_LOG_DIR=./Clash/logs

# Clash API endpoint (External Controller)
# Used by ClashManager.switchSlotProxy() for dynamic proxy updates
CLASH_API_HOST=127.0.0.1
CLASH_CONTROL_PORT=9090

# Clash proxy ports (for TUN mode)
# NOTE: Browsers do NOT use these ports (TUN intercepts directly)
# Only for external tools that need HTTP/SOCKS5 proxy
CLASH_PROXY_PORT=7890
CLASH_SOCKS5_PORT=7891

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# PROXY RETRY CONFIGURATION (v18.0.2) - NEW!
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# Number of proxy attempts before giving up (default: 3)
# If first proxy is dead, system will try 2 more proxies
# Recommended: 3-5 (balance between success rate and speed)
# Higher value = better success rate but longer wait time
MAX_PROXY_RETRIES=3

# Allow fallback to DIRECT routing if all proxies fail (default: false)
# true = Continue without proxy (real IP visible, timezone not synced)
# false = Abort worker if no valid proxy available
# Recommended: false (production), true (testing/debugging)
ALLOW_DIRECT_FALLBACK=false


# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# ğŸ”¥ NEW: DUAL LAUNCH STRATEGY (v4.0.0)
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# Total slots = OTHER_RESERVED + MSEDGE_RESERVED
# ClashManager v3.3.0+ validates slots dynamically from these values

# Slot 1-1000: HARDLINK STRATEGY (OTHER_RESERVED)
# Detection: PROCESS-NAME,worker042.exe,SLOT_042
# Implementation: config.js _createHardlink()
# Supported: Chrome, Firefox, Edge (any browser)
# Location: Same directory as browser executable (NTFS requirement)
OTHERS_RESERVED=1000

# Slot 1001-1200: WORKER DIRECTORY STRATEGY (MSEDGE_RESERVED)
# Detection: PROCESS-PATH,D:\*\edge\worker1001\*,SLOT_1001
# Implementation: config.js createWorkerDirectory()
# Supported: Edge ONLY (due to PROCESS-PATH limitations)
# Location: ./browser/edge/worker{slotIndex}/msedge.exe (hardlink + persistent dir)
MSEDGE_RESERVED=200

# TOTAL SLOTS: 1200 (validated by ClashManager.constructor)
# - Range: 1 to 1200
# - Slot 1-1000: Use config.getBrowserPath() â†’ hardlink strategy
# - Slot 1001-1200: Use config.getBrowserPath() â†’ worker directory strategy

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# PROXY HEALTH MONITORING
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# Health check target (should be fast & reliable)
# Used by ProxyQualityManager.healthCheck()
HEALTH_CHECK_TARGET=http://1.1.1.1
HEALTH_CHECK_INTERVAL=10000
HEALTH_CHECK_TIMEOUT=5000

# Latency thresholds (milliseconds)
# These thresholds determine health_quality score (0-100)
# Formula: See ProxyQualityManager.calculateHealthQuality()
PROXY_LATENCY_EXCELLENT=200
PROXY_LATENCY_GOOD=500
PROXY_LATENCY_ACCEPTABLE=2000
PROXY_LATENCY_THRESHOLD=15000

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# PROXY ROTATION & COOLDOWN (CRITICAL)
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# Enable proxy rotation after each task completion
# When true: Worker calls ProxyPoolManager.rotateProxy() after task
# When false: Proxy stays assigned until worker terminates
PROXY_ROTATION_ENABLED=true

# Cooldown duration after SUCCESSFUL task (milliseconds)
# Proxy cannot be reassigned until: Date.now() >= proxy.cooldown_until
# Recommendation: 60000ms (60 seconds) for IP cooldown
PROXY_COOLDOWN_SUCCESS=60000

# Cooldown duration after FAILED task (milliseconds)
# Longer cooldown for failed proxies to allow recovery time
# Recommendation: 300000ms (5 minutes) for proxy recovery
PROXY_COOLDOWN_FAIL=300000

# Cooldown duration for QUARANTINED proxies (milliseconds)
# Proxies with MAX_FAIL_BEFORE_QUARANTINE failures get quarantined
# Recommendation: 3600000ms (1 hour) for quarantine recovery
PROXY_COOLDOWN_QUARANTINE=3600000

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# PROXY QUALITY SCORING (DB-First Approach)
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# Minimum health quality score to be eligible (0-100)
# Proxies below this score are excluded from getBestProxy()
MIN_HEALTH_QUALITY=50

# Minimum success rate percentage (0-100)
# Formula: (success_count / (success_count + fail_count)) * 100
MIN_SUCCESS_RATE=30

# Maximum consecutive failures before quarantine
# After this threshold, proxy status changes to 'quarantine'
MAX_FAIL_BEFORE_QUARANTINE=10

# Retry configuration (for proxy allocation failures)
# If getBestProxy() returns null, ProxyPoolManager retries this many times
MAX_PROXY_REPLACEMENT_RETRY=5

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# SYSTEM LIMITS (Resource Protection)
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# Maximum number of concurrent workers
# In Clash architecture: 1 worker = 1 slot = 1 Clash proxy group
# Max slots: OTHER_RESERVED + MSEDGE_RESERVED (1200 in this config)
# NOTE: This value is LEGACY, actual limit comes from OTHER_RESERVED + MSEDGE_RESERVED
MAX_WORKERS=1200

# Maximum concurrent HTTP requests (for health checks, DB operations, etc.)
MAX_CONCURRENT_REQUESTS=100

# Maximum proxies to load into memory (NOT USED in DB-first approach)
# Kept for backward compatibility with legacy code
MAX_PROXY_POOL_SIZE=10000

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# TIMEOUT CONFIGURATION
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# HTTP request timeout (milliseconds)
REQUEST_TIMEOUT=30000

# Database & API connection timeout (milliseconds)
CONNECTION_TIMEOUT=10000

# Proxy testing timeout (milliseconds)
PROXY_TEST_TIMEOUT=10000

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# PROXY TESTING TOOLS
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
PROXY_TEST_BATCH_SIZE=50
PROXY_TEST_RETRY=2

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# LOGGING & DEBUGGING
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# Enable debug mode (verbose logging + detailed diagnostics)
# When true: ClashManager, ProxyPoolManager save detailed logs
DEBUG_MODE=true

# Log level: error, warn, info, debug
LOG_LEVEL=info

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# CLASH META LOGGING CONFIGURATION
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# CLASH_LOG: Controls Clash Meta process output verbosity
# NOTE: Only active when DEBUG_MODE=true (2-level gating)
#
# Levels:
#   0 = NO LOG         - Completely silent (no terminal, no file)
#   1 = TERMINAL ONLY  - Live output in terminal only (no file)
#   2 = TERMINAL + FILE- Full debug (filtered terminal + complete file)
#   3 = FILE ONLY      - Clean terminal + complete file (DEFAULT)
#
# Production (DEBUG_MODE=false): Always silent terminal, file-only logging
# Development (DEBUG_MODE=true): Controlled by CLASH_LOG value
#
# Default: 3 (FILE ONLY - clean terminal)
CLASH_LOG=3

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# ğŸŸ¡ BROWSER AUTOMATION (Mode 1-3)
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# Session Management (Mode 1-2)
SESSIONS_DIR=./sessions
MATURE_PROFILE_AGE_HOURS=48

# Device Configuration
ALLOWED_DEVICES=win10,win11

# Traffic Targets
TARGET_TRAFFIC_MIN=2000
TARGET_TRAFFIC_MAX=6000

# Duration (Reading Time Simulation)
DURATION_MIN_SEC=40
DURATION_MAX_SEC=90

# Behavior Probability (Low CTR / Safe Mode)
CHANCE_SCROLL=0.6
CHANCE_HOVER=0.25
CHANCE_CLICK_INTERNAL=0.004
CHANCE_CLICK_EXTERNAL=0.0025
CHANCE_COOKIE=0.1
POPUP_FOLLOW_CHANCE=0.05

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# BROWSER EXECUTABLE PATHS (Dual Launch Strategy v4.0.0)
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# CRITICAL NOTES:
# 1. HARDLINK STRATEGY (Slot 1-1000):
#    - Chrome: C:\Program Files\Google\Chrome\Application\worker042.exe
#    - Firefox: D:\QTE\Browser\Firefox\worker042.exe
#    - Edge: D:\QTE\browser\edge\worker042.exe
#    - Hardlink created in SAME directory as executable (NTFS requirement)
#
# 2. WORKER DIRECTORY STRATEGY (Slot 1001-1200):
#    - Edge ONLY: D:\QTE\browser\edge\worker1001\msedge.exe
#    - Directory structure:
#      ./browser/edge/worker1001/msedge.exe (hardlink from parent)
#      ./browser/edge/worker1002/msedge.exe (hardlink from parent)
#    - Persistent directories for profile isolation
#
# 3. PATH RESOLUTION:
#    - Can be folder path (resolveExecutable will find .exe)
#    - Can be direct .exe path (used as-is)
#    - Pool paths: comma-separated for random selection

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# CHROME PATHS (Hardlink Strategy - Slot 1-1000)
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
PATH_CHROME=C:\Program Files\Google\Chrome\Application\chrome.exe
PATH_CHROME_POOL=D:\QuantumTrafficEngine\Browser\chrome\Latest_win64-145.0.7628.0\chrome.exe,D:\QuantumTrafficEngine\Browser\chrome\win64-143.0.7499.192\chrome.exe,D:\QuantumTrafficEngine\Browser\chrome\win64-144.0.7559.31\chrome.exe,D:\QuantumTrafficEngine\Browser\chrome\chromium\chrome.exe

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# EDGE PATHS (Dual Strategy - Both Slot Types)
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# PRIMARY: Used for both hardlink (1-1000) and worker directory (1001-1200)
# Worker directory implementation:
# - Slot 1001: D:\QuantumTrafficEngine\browser\edge\worker1001\msedge.exe
# - Slot 1002: D:\QuantumTrafficEngine\browser\edge\worker1002\msedge.exe
# - Parent executable: D:\QuantumTrafficEngine\Browser\edge\msedge.exe
# - Hardlink: fs.linkSync(parent, worker1001/msedge.exe)
PATH_EDGE=D:\QuantumTrafficEngine\Browser\edge\msedge.exe
PATH_EDGE_POOL=D:\QuantumTrafficEngine\Browser\

# Base directory for worker directories (relative to project root)
# CRITICAL: Must match PATH_EDGE parent directory
# Used by config.js createWorkerDirectory()
BROWSER_BASE_DIR=./browser

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# FIREFOX PATHS (Hardlink Strategy - Slot 1-1000)
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
PATH_FIREFOX=D:\QuantumTrafficEngine\Browser\Firefox\Firefox_win64-stable_146.0.1\core\firefox.exe
PATH_FIREFOX_POOL=D:\QuantumTrafficEngine\Browser\Firefox\Firefox_win64-stable_111.0.1\core\firefox.exe,D:\QuantumTrafficEngine\Browser\Firefox\Firefox_win64-nightly_148.0a1\firefox\firefox.exe,D:\QuantumTrafficEngine\Browser\Firefox\Firefox_win64-beta_147.0b9\core\firefox.exe

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# OTHER BROWSERS (Optional - Hardlink Strategy Only)
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
PATH_OPERA=C:\Users\Administrator\AppData\Local\Programs\Opera\opera.exe
PATH_BRAVE=C:\Program Files\BraveSoftware\Brave-Browser\Application\brave.exe

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# URL SHORTENER & TRACKING
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
BITLY_API=df8496354ddecc0cd45cf72b2712f3f71b886dde
SHORTLINK_PROBABILITY=90

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# ğŸ“‹ CLASH META ARCHITECTURE v4.0.0 (DUAL LAUNCH STRATEGY)
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
#
# â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
# â”‚ WINDOWS HOST (Clash Meta TUN Routing)                                       â”‚
# â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
# â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
# â”‚ â”‚ SLOT 1-1000: HARDLINK STRATEGY (OTHER_RESERVED)                         â”‚ â”‚
# â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
# â”‚ â”‚ config.js: _routeBySlot(selectedPath, browserName, workerSlot)          â”‚ â”‚
# â”‚ â”‚   â””â”€ if (workerSlot <= 1000) â†’ _createHardlink()                        â”‚ â”‚
# â”‚ â”‚       â””â”€ fs.linkSync(chrome.exe, worker042.exe)                          â”‚ â”‚
# â”‚ â”‚           â””â”€ Location: Same dir as browser (NTFS requirement)            â”‚ â”‚
# â”‚ â”‚               â”œâ”€ Chrome: C:\Program Files\...\worker042.exe              â”‚ â”‚
# â”‚ â”‚               â”œâ”€ Firefox: D:\QTE\Browser\Firefox\worker042.exe           â”‚ â”‚
# â”‚ â”‚               â””â”€ Edge: D:\QTE\browser\edge\worker042.exe                 â”‚ â”‚
# â”‚ â”‚                                                                           â”‚ â”‚
# â”‚ â”‚ Clash Detection: PROCESS-NAME,worker042.exe,SLOT_042                     â”‚ â”‚
# â”‚ â”‚   â””â”€ TUN intercepts all traffic from worker042.exe                       â”‚ â”‚
# â”‚ â”‚       â””â”€ Route to: Proxy_Pool_042                                        â”‚ â”‚
# â”‚ â”‚           â””â”€ Forward to: socks5://proxy.com:1080                         â”‚ â”‚
# â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
# â”‚                                                                               â”‚
# â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
# â”‚ â”‚ SLOT 1001-1200: WORKER DIRECTORY STRATEGY (MSEDGE_RESERVED)             â”‚ â”‚
# â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
# â”‚ â”‚ config.js: _routeBySlot(selectedPath, browserName, workerSlot)          â”‚ â”‚
# â”‚ â”‚   â””â”€ if (workerSlot > 1000) â†’ createWorkerDirectory()                   â”‚ â”‚
# â”‚ â”‚       â””â”€ Create: ./browser/edge/worker1001/ (persistent directory)      â”‚ â”‚
# â”‚ â”‚           â””â”€ fs.linkSync(parent/msedge.exe, worker1001/msedge.exe)       â”‚ â”‚
# â”‚ â”‚               â””â”€ Location: D:\QTE\browser\edge\worker1001\msedge.exe    â”‚ â”‚
# â”‚ â”‚                   â”œâ”€ Parent: D:\QTE\Browser\edge\msedge.exe             â”‚ â”‚
# â”‚ â”‚                   â””â”€ Hardlink: worker1001\msedge.exe â†’ parent           â”‚ â”‚
# â”‚ â”‚                                                                           â”‚ â”‚
# â”‚ â”‚ Clash Detection: PROCESS-PATH,D:\*\edge\worker1001\*,SLOT_1001          â”‚ â”‚
# â”‚ â”‚   â””â”€ TUN intercepts traffic from ANY process in worker1001\ directory   â”‚ â”‚
# â”‚ â”‚       â””â”€ Route to: Proxy_Pool_1001                                      â”‚ â”‚
# â”‚ â”‚           â””â”€ Forward to: socks5://proxy.com:1080                         â”‚ â”‚
# â”‚ â”‚                                                                           â”‚ â”‚
# â”‚ â”‚ CRITICAL: Edge ONLY for PROCESS-PATH detection (Clash limitation)       â”‚ â”‚
# â”‚ â”‚   â””â”€ If browserName !== 'Edge' â†’ throw Error()                          â”‚ â”‚
# â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
# â”‚                                                                               â”‚
# â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
# â”‚ â”‚ COMMON FLOW (Both Strategies)                                            â”‚ â”‚
# â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
# â”‚ â”‚ 1. ProxyPoolManager.assignProxy(slotIndex, workerId)                    â”‚ â”‚
# â”‚ â”‚    â””â”€ ProxyQualityManager.getBestProxy() â†’ MongoDB aggregation         â”‚ â”‚
# â”‚ â”‚        â””â”€ Filter: cooldown_until <= now, in_use=false, status='live'   â”‚ â”‚
# â”‚ â”‚            â””â”€ Mark: in_use=true, assigned_to_slot=slotIndex            â”‚ â”‚
# â”‚ â”‚                â””â”€ ClashManager.switchSlotProxy(slotIndex, proxy)        â”‚ â”‚
# â”‚ â”‚                    â””â”€ Clash API: PUT /proxies/Proxy_Pool_{slotId}      â”‚ â”‚
# â”‚ â”‚                                                                           â”‚ â”‚
# â”‚ â”‚ 2. BrowserLauncher.launchBrowser(workerId, hardlinkPath, ...)           â”‚ â”‚
# â”‚ â”‚    â””â”€ spawn(hardlinkPath, args) â†’ NO --proxy-server flag                â”‚ â”‚
# â”‚ â”‚        â””â”€ Browser traffic â†’ TUN interface (automatic)                   â”‚ â”‚
# â”‚ â”‚            â””â”€ Clash Meta routes via PROCESS-NAME or PROCESS-PATH        â”‚ â”‚
# â”‚ â”‚                                                                           â”‚ â”‚
# â”‚ â”‚ 3. After Task Completion                                                 â”‚ â”‚
# â”‚ â”‚    â””â”€ ProxyPoolManager.rotateProxy(slotIndex, workerId)                â”‚ â”‚
# â”‚ â”‚        â”œâ”€ releaseProxy() â†’ in_use=false, cooldown_until=now+duration   â”‚ â”‚
# â”‚ â”‚        â””â”€ assignProxy() â†’ getBestProxy() + switchSlotProxy()            â”‚ â”‚
# â”‚ â”‚            â””â”€ Browser continues (NO RESTART) with new proxy             â”‚ â”‚
# â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
# â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
#
# KEY ARCHITECTURAL FACTS (v4.0.0):
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# 
# 1. NO LSG (Linux Smart Gateway):
#    - Clash Meta runs locally on Windows
#    - No tun2proxy, no remote gateway calls
#    - No LINUX_GATEWAY_IP, LINUX_GATEWAY_PORT, LINUX_INTERFACE
#    - All routing handled by Clash Meta TUN mode
#
# 2. NO VIP ALLOCATION:
#    - No 192.168.x.x IP injection to NIC
#    - No steering.exe, no pid_tracker.exe for VIP routing
#    - No SPOOF_SUBNETS, WIN_INTERFACE_NAME, WIN_DEFAULT_GATEWAY
#    - Process identification via hardlink naming (worker###.exe)
#    - Or via persistent directory (worker###/)
#
# 3. DUAL LAUNCH STRATEGY:
#    - Slot 1-1000: Hardlink (worker###.exe)
#      * Detection: PROCESS-NAME,worker042.exe,SLOT_042
#      * Supports: Chrome, Firefox, Edge (all browsers)
#      * Location: Same directory as browser executable
#    - Slot 1001-1200: Worker Directory (worker###/)
#      * Detection: PROCESS-PATH,D:\*\edge\worker1001\*,SLOT_1001
#      * Supports: Edge ONLY (Clash PROCESS-PATH limitation)
#      * Location: ./browser/edge/worker###/ (persistent directory)
#
# 4. PROXY INJECTION:
#    - Initial assignment: ProxyPoolManager.assignProxy()
#    - Runtime switching: ClashManager.switchSlotProxy()
#    - NO BROWSER RESTART for proxy rotation
#    - Dynamic slot validation (ClashManager v3.3.0+)
#
# 5. COOLDOWN MECHANISM:
#    - After release: cooldown_until = now + duration
#    - getBestProxy() filters: cooldown_until <= now
#    - Automatic eligibility recovery when cooldown expires
#
# 6. SLOT ISOLATION:
#    - Total: 1200 slots (OTHER_RESERVED + MSEDGE_RESERVED)
#    - 1 slot = 1 worker = 1 Clash proxy group = 1 proxy
#    - Each slot has independent proxy lifecycle
#
# 7. PROCESS-BASED ROUTING:
#    - Hardlink: PROCESS-NAME,worker001.exe,SLOT_001
#    - Worker Dir: PROCESS-PATH,D:\*\edge\worker1001\*,SLOT_1001
#    - TUN intercepts all traffic (no PID tracking needed)
#    - No shared memory, no NAT, no VIP injection
#
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# ğŸš€ QUICK START CHECKLIST (Clash Meta v4.0.0)
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
#
# Before running opsi4.js, verify:
#
# âœ… 1. MongoDB accessible
#       Test: mongosh "mongodb://quantumtraffic:113333555555@172.16.103.253:27017/QuantumTrafficDB?authSource=admin"
#       Action: Ensure MongoDB replica set is running
#
# âœ… 2. MongoDB proxy schema migrated (v3.1.0 schema)
#       Test: db.proxies.findOne() â†’ check for cooldown_until field
#       Action: Run migration script (see MIGRATION GUIDE below)
#
# âœ… 3. MongoDB indexes created
#       Test: db.proxies.getIndexes() â†’ check idx_proxy_selection_v2
#       Action: Create compound index for cooldown query optimization
#
# âœ… 4. Clash Meta binary exists
#       Test: Test-Path ./Clash/clash.exe
#       Action: Download mihomo-windows-amd64-compatible.exe
#       URL: https://github.com/MetaCubeX/mihomo/releases
#
# âœ… 5. Administrator privileges (CRITICAL for TUN mode)
#       Test: net session (PowerShell as Admin)
#       Action: Right-click PowerShell â†’ Run as Administrator
#
# âœ… 6. QTE_ID configured in .env
#       Test: echo $env:QTE_ID (PowerShell)
#       Expected: Non-empty string (e.g., QTE-DESKTOP-01)
#
# âœ… 7. Proxies imported to MongoDB
#       Test: db.proxies.countDocuments({ status: 'live' })
#       Minimum: (OTHER_RESERVED + MSEDGE_RESERVED) Ã— 2 = 2400+ proxies
#       Recommendation: 10,000+ proxies for smooth operation
#
# âœ… 8. Cooldown durations configured
#       Test: echo $env:PROXY_COOLDOWN_SUCCESS
#       Expected: 60000 (or your custom value)
#
# âœ… 9. Browser executables exist
#       Test: Test-Path "C:\Program Files\Google\Chrome\Application\chrome.exe"
#       Test: Test-Path "D:\QuantumTrafficEngine\Browser\edge\msedge.exe"
#       Action: Verify PATH_CHROME, PATH_EDGE, PATH_FIREFOX in .env
#
# âœ… 10. Worker directory structure (for MSEDGE slots)
#       Test: Test-Path "./browser/edge/"
#       Action: Will be auto-created by config.js createWorkerDirectory()
#       Note: Parent msedge.exe must exist for hardlink creation
#
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# ğŸ“Š DATABASE MIGRATION GUIDE (v3.1.0 â†’ v4.0.0)
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# NO SCHEMA CHANGES in v4.0.0 (same as v3.1.0)
# If migrating from v3.0 or earlier, follow v3.1.0 migration guide
#
# STEP 1: Backup Database
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# mongodump --uri="mongodb://quantumtraffic:113333555555@172.16.103.253:27017/QuantumTrafficDB?authSource=admin" --out=./backup/pre-v4/
#
# STEP 2: Add New Fields (if not already done in v3.1.0)
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# mongosh "mongodb://quantumtraffic:113333555555@172.16.103.253:27017/QuantumTrafficDB?authSource=admin"
# > use QuantumTrafficDB;
# > db.proxies.updateMany(
#     {},
#     {
#       $set: {
#         cooldown_until: null,
#         assigned_to_slot: null,
#         assigned_to_worker: null,
#         assigned_at: null,
#         rotation_count: 0,
#         last_rotation: null
#       }
#     }
#   );
#
# STEP 3: Create Indexes (if not already done in v3.1.0)
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# > db.proxies.createIndex(
#     {
#       status: 1,
#       in_use: 1,
#       cooldown_until: 1,
#       health_quality: -1
#     },
#     {
#       name: "idx_proxy_selection_v2",
#       background: true
#     }
#   );
#
# > db.proxies.createIndex(
#     { assigned_to_slot: 1, in_use: 1 },
#     { name: "idx_slot_lookup", sparse: true, background: true }
#   );
#
# STEP 4: Verify Migration
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# > db.proxies.findOne();  // Check fields exist
# > db.proxies.getIndexes();  // Check indexes created
#
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# ğŸ“ TROUBLESHOOTING (Clash Meta v4.0.0)
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
#
# Issue: "INVALID SLOT {slotIndex} - VALID RANGES: OTHERS 1-1000, MSEDGE 1001-1200"
# Fix:   1. Check OTHER_RESERVED=1000 and MSEDGE_RESERVED=200 in .env
#        2. Verify worker slot assignment logic in opsi4.js
#        3. ClashManager validates slots dynamically from env
#        4. Total slots = OTHER_RESERVED + MSEDGE_RESERVED (1200)
#
# Issue: "MSEDGE slots (1001+) are Edge-only!"
# Fix:   1. Slot 1001-1200 require browserName === 'Edge'
#        2. PROCESS-PATH detection only works with Edge
#        3. Use slot 1-1000 for Chrome/Firefox (hardlink strategy)
#        4. Or increase OTHER_RESERVED to support more browsers
#
# Issue: "Worker directory not found: D:\QTE\browser\edge\worker1001"
# Fix:   1. Check BROWSER_BASE_DIR=./browser in .env
#        2. Verify PATH_EDGE parent directory matches BROWSER_BASE_DIR
#        3. config.js createWorkerDirectory() auto-creates directory
#        4. Ensure parent msedge.exe exists for hardlink creation
#
# Issue: "Hardlink creation failed: EXDEV (cross-device link)"
# Fix:   1. Hardlink must be on same drive as browser executable
#        2. Check PATH_EDGE and BROWSER_BASE_DIR on same volume
#        3. Worker directory hardlinks: ./browser/edge/worker1001/msedge.exe
#        4. Parent executable: D:\QTE\Browser\edge\msedge.exe
#        5. Both must be on same drive (e.g., D:\)
#
# Issue: "QTE_ID not configured in .env"
# Fix:   1. Add QTE_ID=QTE-DESKTOP-01 to .env file
#        2. Use alphanumeric + hyphens only (no spaces)
#        3. Restart QTE application
#
# Issue: "Clash binary not found"
# Fix:   1. Download mihomo-windows-amd64-compatible.exe
#        2. Rename to clash.exe
#        3. Place in ./Clash/clash.exe
#        4. Verify: Test-Path ./Clash/clash.exe
#
# Issue: "Administrator privileges required"
# Fix:   1. Close current PowerShell
#        2. Right-click PowerShell icon
#        3. Select "Run as Administrator"
#        4. Restart: node engine.js â†’ select mode 4
#
# Issue: "TUN interface not found"
# Fix:   1. Check Clash logs: ./Clash/logs/clash_{QTE_ID}.log
#        2. Verify TUN driver: netsh interface show interface
#        3. Look for "mihomo-tun" or "clash-tun" interface
#        4. If missing: Reinstall Clash Meta binary
#
# Issue: "No available proxy (getBestProxy returned null)"
# Fix:   1. Check proxy count: db.proxies.countDocuments({ status: 'live', in_use: false })
#        2. Check cooldowns: db.proxies.find({ cooldown_until: { $gt: new Date() } }).count()
#        3. Wait for cooldowns to expire
#        4. Or import more proxies to DB (min 2400+ for 1200 slots)
#
# Issue: "Proxy rotation not working"
# Fix:   1. Check PROXY_ROTATION_ENABLED=true in .env
#        2. Verify ProxyPoolManager initialized (check logs)
#        3. Check Clash API: curl http://127.0.0.1:9090/proxies/Proxy_Pool_001
#        4. Verify switchSlotProxy() called (check logs)
#
# Issue: "Cooldown not respected"
# Fix:   1. Verify migration ran: db.proxies.findOne() â†’ check cooldown_until
#        2. Check ProxyQualityManager aggregation pipeline (debug logs)
#        3. Verify system time synchronized (cooldown uses Date.now())
#
# Issue: "Worker hangs after browser launch"
# Fix:   1. Check Clash running: tasklist | findstr clash.exe
#        2. Check TUN interface: netsh interface show interface | findstr tun
#        3. Check hardlink created: dir *.exe (worker###.exe should exist)
#        4. Check Clash API: http://127.0.0.1:9090/connections
#
# Issue: "Browser not using proxy (direct connection)"
# Fix:   1. Verify Clash routing rule: PROCESS-NAME,worker###.exe,SLOT_###
#        2. Or: PROCESS-PATH,D:\*\edge\worker1001\*,SLOT_1001
#        3. Check Clash config: ./Clash/config/{QTE_ID}_clash.yaml
#        4. Regenerate config: Delete config file, restart QTE
#        5. Test manually: curl --proxy 127.0.0.1:7890 https://api.ipify.org
#
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# ğŸ”— RELATED FILES & DOCUMENTATION
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
#
# Code Files (v4.0.0):
# â”œâ”€ config.js v87.0.0 (Dual launch strategy + routing logic)
# â”œâ”€ engine.js v71.0.0 (Clash Meta launcher)
# â”œâ”€ opsi4.js v19.0.0 (Worker orchestrator + dual strategy integration)
# â”œâ”€ ClashManager.js v3.3.0 (Dynamic slot validation)
# â”œâ”€ BrowserLauncher.js v4.0.1 (Multi-directory hardlink cleanup)
# â”œâ”€ ProxyPoolManager.js (Proxy lifecycle manager)
# â””â”€ ProxyQualityManager.js v4.1.0+ (DB-first selection)
#
# Config Files:
# â”œâ”€ .env (THIS FILE - v4.0.0)
# â”œâ”€ ./Clash/config_clash.json (User DNS + bypass domains)
# â””â”€ ./Clash/config/{QTE_ID}_clash.yaml (Generated by ClashStaticGenerator)
#
# Migration Scripts:
# â””â”€ See "DATABASE MIGRATION GUIDE" section above
#
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# END OF CONFIGURATION FILE v4.0.0
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
